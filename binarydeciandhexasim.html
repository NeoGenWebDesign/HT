<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binary, Decimal, Hexadecimal Conversion</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Consolas', 'Courier New', monospace;
            background: linear-gradient(180deg, #353636 50%, #032a36 75%);
            min-height: 100vh;
        }
        a {
            display: block;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            text-align: center;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        .header-section {
            background-color: #1b2d5f; /* Blue 800 */
            color: white;
            border-top-left-radius: 0.75rem;
            border-top-right-radius: 0.75rem;
        }
        .conversion-input, .conversion-output {
            transition: all 0.3s ease;
        }
        .explanation-box {
            background-color: #eff6ff; /* Blue 50 */
            border-left: 5px solid #1b2d5f; /* Blue 600 */
            padding: 1.5rem;
            min-height: 250px;
            overflow-y: auto;
        }
        .explanation-box table {
            font-size: 0.85rem;
        }
    </style>
</head>
<body class="p-4 md:p-10 min-h-screen">

    <div class="max-w-6xl mx-auto">
        <h1 class="text-4xl font-extrabold text-orange-500 mb-2 text-center">
            Number Base Conversion Lab
        </h1>
        <p class="text-lg text-white mb-8 text-center">
            Explore conversion between <strong>Decimal (Base 10)</strong>, <strong>Binary (Base 2)</strong>, and <strong>Hexadecimal (Base 16)</strong>.
        </p>
        <p class="text-sm text-yellow-500 mb-8 text-center">
            Press F5 or Reload/Refresh Browser to Reset Simulation.
        </p>
        <a id="link" class="text-sm hover:text-lime-500 text-yellow-200 mb-8 text-center" href="index.html">
            Back to Simulations Index
        </a>

        <!-- Input and Outputs Section -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            
            <!-- Decimal Input (Base 10) -->
            <div class="card conversion-input border-t-4 border-blue-600 p-4">
                <label for="dec-input" class="block text-sm font-bold text-gray-700 mb-2">Decimal (Base 10)</label>
                <input type="number" id="dec-input" value="173" min="0" oninput="convertFromDecimal()" class="w-full p-3 border-2 border-blue-300 rounded-lg text-2xl font-mono focus:ring-blue-500 focus:border-blue-500" placeholder="e.g., 173">
            </div>

            <!-- Binary Output/Input (Base 2) -->
            <div class="card conversion-output border-t-4 border-green-600 p-4">
                <label for="bin-input" class="block text-sm font-bold text-gray-700 mb-2">Binary (Base 2)</label>
                <input type="text" id="bin-input" value="" oninput="convertFromBinary()" class="w-full p-3 border-2 border-green-300 rounded-lg text-2xl font-mono focus:ring-green-500 focus:border-green-500" placeholder="e.g., 10101101">
            </div>

            <!-- Hexadecimal Output/Input (Base 16) -->
            <div class="card conversion-output border-t-4 border-red-600 p-4">
                <label for="hex-input" class="block text-sm font-bold text-gray-700 mb-2">Hexadecimal (Base 16)</label>
                <input type="text" id="hex-input" value="" oninput="convertFromHex()" class="w-full p-3 border-2 border-red-300 rounded-lg text-2xl font-mono uppercase focus:ring-red-500 focus:border-red-500" placeholder="e.g., AD">
            </div>

        </div>

        <!-- Explanation Section -->
        <div class="card mt-8">
            <div class="header-section p-4">
                <h2 class="text-xl font-semibold">Step-by-Step Conversion Method</h2>
                <p class="text-sm text-orange-300">The primary methods shown below are Decimal to Binary (Repeated Division) and Binary to Hexadecimal (4-bit Grouping).</p>
            </div>
            <div id="explanation-container" class="explanation-box rounded-lg">
                <h3 class="text-xl font-bold text-blue-800 mb-3">Starting Point</h3>
                <p class="text-gray-700">Type a number into any of the three boxes above to see the equivalent values and the detailed method for conversion.</p>
            </div>
        </div>

    </div>

    <script>
        // Global references for simplicity
        const decInput = document.getElementById('dec-input');
        const binInput = document.getElementById('bin-input');
        const hexInput = document.getElementById('hex-input');
        const explanationContainer = document.getElementById('explanation-container');

        // --- Validation Helpers ---

        /** Enforces only 0s and 1s in the binary input. */
        binInput.onkeyup = function() {
            this.value = this.value.replace(/[^01]/g, '');
        };

        /** Enforces only valid hexadecimal characters (0-9, A-F) and converts to uppercase. */
        hexInput.onkeyup = function() {
            this.value = this.value.toUpperCase().replace(/[^0-9A-F]/g, '');
        };

        // --- Core Conversion Logic ---

        /**
         * Converts from Decimal and updates Binary/Hex outputs.
         */
        function convertFromDecimal() {
            const decValue = parseInt(decInput.value);
            if (isNaN(decValue) || decValue < 0) {
                clearOutputs();
                explanationContainer.innerHTML = '<p class="text-red-700 font-bold">Please enter a valid positive integer in the Decimal field.</p>';
                return;
            }

            // Built-in JavaScript conversion methods
            const binValue = decValue.toString(2);
            const hexValue = decValue.toString(16).toUpperCase();

            // Update outputs (without triggering their oninput events)
            binInput.value = binValue;
            hexInput.value = hexValue;

            // Generate explanations
            explainDecToBin(decValue);
        }

        /**
         * Converts from Binary and updates Decimal/Hex outputs.
         */
        function convertFromBinary() {
            const binValue = binInput.value.trim();
            if (!/^[01]+$/.test(binValue) || binValue === "") {
                clearOutputs(true, false); // Clear only Dec and Hex
                explanationContainer.innerHTML = '<p class="text-red-600 font-bold">Please enter a valid Binary string (only 0s and 1s).</p>';
                return;
            }
            
            // Convert Binary to Decimal (Base 2 to Base 10)
            const decValue = parseInt(binValue, 2);
            
            // Convert Decimal to Hex (Base 10 to Base 16)
            const hexValue = decValue.toString(16).toUpperCase();

            decInput.value = decValue;
            hexInput.value = hexValue;

            // Generate explanations, focusing on Binary to Hex (Grouping)
            explainBinToHex(binValue);
        }

        /**
         * Converts from Hexadecimal and updates Decimal/Binary outputs.
         */
        function convertFromHex() {
            const hexValue = hexInput.value.trim();
            if (!/^[0-9A-F]+$/.test(hexValue) || hexValue === "") {
                clearOutputs(false, true); // Clear only Dec and Bin
                explanationContainer.innerHTML = '<p class="text-red-600 font-bold">Please enter a valid Hexadecimal string (0-9, A-F).</p>';
                return;
            }
            
            // Convert Hex to Decimal (Base 16 to Base 10)
            const decValue = parseInt(hexValue, 16);
            
            // Convert Decimal to Binary (Base 10 to Base 2)
            const binValue = decValue.toString(2);

            decInput.value = decValue;
            binInput.value = binValue;

            // Generate explanations, focusing on Binary to Hex (which is usually the easiest way)
            explainBinToHex(binValue);
        }

        /**
         * Clears output fields except for the field currently being modified.
         * @param {boolean} keepBin - True if binary input should be preserved.
         * @param {boolean} keepHex - True if hex input should be preserved.
         */
        function clearOutputs(keepBin = false, keepHex = false) {
            decInput.value = "";
            if (!keepBin) binInput.value = "";
            if (!keepHex) hexInput.value = "";
        }

        // --- Explanation Generators ---

        /**
         * Generates the step-by-step explanation for Decimal to Binary conversion
         * using the Repeated Division Method.
         * @param {number} dec - The decimal value.
         */
        function explainDecToBin(dec) {
            let currentNumber = dec;
            let explanation = `<h3 class="text-xl font-bold text-blue-800 mb-3">Conversion: ${dec}_{10} \implies Binary (Base 2)</h3>`;
            explanation += `<p class="text-gray-700 mb-4">Method: **Repeated Division by 2**. The binary result is the sequence of remainders, read from bottom to top.</p>`;
            explanation += `<table class="w-full text-left border-collapse table-auto">
                <thead>
                    <tr class="bg-blue-200 text-blue-800">
                        <th class="p-2 border border-blue-300">Operation</th>
                        <th class="p-2 border border-blue-300">Quotient</th>
                        <th class="p-2 border border-blue-300">Remainder (Bit)</th>
                    </tr>
                </thead>
                <tbody class="font-mono">`;

            if (dec === 0) {
                explanation += `<tr><td class="p-2 border border-blue-200" colspan="3">The decimal number 0 is $0_2$.</td></tr>`;
            } else {
                let binaryResult = [];
                let step = 1;
                while (currentNumber > 0) {
                    const quotient = Math.floor(currentNumber / 2);
                    const remainder = currentNumber % 2;
                    binaryResult.unshift(remainder);
                    
                    explanation += `
                        <tr class="${step % 2 === 0 ? 'bg-blue-50' : ''}">
                            <td class="p-2 border border-blue-200">${currentNumber} $\div$ 2</td>
                            <td class="p-2 border border-blue-200">${quotient}</td>
                            <td class="p-2 border border-blue-200 font-bold text-lg">${remainder}</td>
                        </tr>
                    `;
                    currentNumber = quotient;
                    step++;
                }

                explanation += `</tbody></table>`;
                explanation += `<p class="mt-4 text-center font-bold text-lg text-teal-500">Result: Read remainders UPWARDS $\implies$ **${binaryResult.join('')}**</p>`;
            }
            explanationContainer.innerHTML = explanation;
        }


        /**
         * Generates the step-by-step explanation for Binary to Hexadecimal conversion
         * using the 4-bit Grouping Method.
         * @param {string} bin - The binary string.
         */
        function explainBinToHex(bin) {
            let paddedBin = bin;
            // Pad the binary string with leading zeros so its length is a multiple of 4
            while (paddedBin.length % 4 !== 0) {
                paddedBin = '0' + paddedBin;
            }

            let explanation = `<h3 class="text-xl font-bold text-blue-800 mb-3">Conversion: Binary ($${bin}_2$) \implies Hexadecimal (Base 16)</h3>`;
            explanation += `<p class="text-gray-700 mb-4">Method: **4-bit Grouping**. Since $2^4 = 16$, every 4 binary digits (a **nibble**) converts directly to one hexadecimal digit.</p>`;

            let hexResult = '';
            explanation += `<div class="flex flex-wrap justify-center items-center font-mono text-center gap-4">`;

            for (let i = 0; i < paddedBin.length; i += 4) {
                const nibble = paddedBin.substring(i, i + 4);
                // Convert the 4-bit nibble to its decimal value first, then to Hex character
                const decValue = parseInt(nibble, 2);
                const hexChar = decValue.toString(16).toUpperCase();
                
                hexResult += hexChar;

                explanation += `
                    <div class="p-3 border border-gray-300 rounded-lg shadow-md bg-white">
                        <p class="text-2xl font-bold text-red-600 mb-1">${nibble}</p>
                        <p class="text-sm text-gray-500">Binary Nibble</p>
                        <hr class="my-2 border-gray-200">
                        <p class="text-lg font-bold text-green-700">${hexChar} ($${decValue}_{10}$)</p>
                        <p class="text-sm text-gray-500">Hex Value</p>
                    </div>
                `;
            }

            explanation += `</div>`;
            explanation += `<p class="mt-6 text-center font-bold text-xl text-teal-500">Combined Hex Result: **${hexResult}**</p>`;
            
            explanationContainer.innerHTML = explanation;
        }

        // --- Initial Call ---

        // Convert the default value on page load
        window.onload = () => {
            convertFromDecimal();
        };

    </script>
</body>
</html>